[{"path":"/articles/00-spm-example.html","id":"working-examples-of-the-spmr-package","dir":"Articles","previous_headings":"","what":"Working examples of the spmR package","title":"spm-example","text":"vignette provides examples use spmR package run Standard Projection Model (SPM) Alaska groundfish. SPM stock assessment model used project future status fish stocks. spmR package provides R interface SPM model, allowing users run model analyze results R. three main functions spmR package: runSPM, plotSPM, dat2list (list2dat). runSPM function runs SPM model returns results data frame. plotSPM function creates plots SPM results. list2dat dat2list functions convert local R lists datafiles used SPM externally. draft function called print_Tier3_tables set provide capabilities create tables markdown documents. vignette demonstrates use functions run SPM model analyze results.","code":""},{"path":"/articles/00-spm-example.html","id":"example-sets","dir":"Articles","previous_headings":"","what":"Example sets","title":"spm-example","text":"following case studies applied.","code":""},{"path":"/articles/00-spm-example.html","id":"atka-mackerel","dir":"Articles","previous_headings":"Example sets","what":"Atka mackerel","title":"spm-example","text":"","code":"df <- runSPM(here::here(\"examples\",\"atka\"),run=FALSE) setwd(\"spmR\") plotSPM(df)"},{"path":"/articles/00-spm-example.html","id":"bsai-northern-rock-sole","dir":"Articles","previous_headings":"Example sets","what":"BSAI northern rock sole","title":"spm-example","text":"","code":"df <- runSPM(here::here(\"examples\",\"BSAI NRS\"),run=FALSE) plotSPM(df)"},{"path":"/articles/00-spm-example.html","id":"ebs-pollock","dir":"Articles","previous_headings":"Example sets","what":"EBS pollock","title":"spm-example","text":"","code":"df <- runSPM(here::here(\"examples\",\"ebspollock\"),run=FALSE) plotSPM(df)"},{"path":"/articles/00-spm-example.html","id":"bsai-yellowfin-sole","dir":"Articles","previous_headings":"Example sets","what":"BSAI yellowfin sole","title":"spm-example","text":"","code":"df <- runSPM(here::here(\"examples\",\"yfs\"),run=FALSE)  plotSPM(df)"},{"path":[]},{"path":[]},{"path":"/articles/01-Background.html","id":"update","dir":"Articles","previous_headings":"Introduction","what":"2024 update","title":"Standard Projection Model","text":"following priorities updated light changes requirements. Discussion projection alternatives NOAA General Counsel.","code":""},{"path":"/articles/01-Background.html","id":"proposal","dir":"Articles","previous_headings":"Introduction","what":"Proposal","title":"Standard Projection Model","text":"light , group noted scenario corresponds Author’s recommendation based FMP amendment, Tier 3 based Fspr rates, form main set results present. may require consideration years pre-specified catches needed two-year projection catch projection assessment lapsed years. cases, might benefit (accuracy’s sake) iteration next-year’s catch likely differ say authors recommended ABC. Additional optional projection scenarios might include setting fishing mortality recent average (maybe zero) contrast. Updates ensure code works subset example models completed shown github site.","code":""},{"path":"/articles/01-Background.html","id":"earlier-background-and-documentation","dir":"Articles","previous_headings":"Introduction","what":"Earlier background and documentation","title":"Standard Projection Model","text":"seems dead link now…: https://archive.fisheries.noaa.gov/afsc/refm/stocks/projections.htm November 2004 groundfish Plan Team meetings Teams requested work enhancing standardized projection model (SPM) methodology. current projection model methods used since 1999 designed provide needed projection scenarios annual Environmental Assessment (EA) TAC specifications. Additionally, two scenarios conducted determine whether stock currently overfished condition approaching overfished condition. details projection scenarios given Fig. 1. current methodology problematic number reasons. First, model software designed provide basis ABC OFL recommendations beyond coming year. amendment 48/48, done 2004, Council required make ABC, TAC, OFL recommendations next two years (.e., 2005 2006). projection model software modified accommodate . Also, number assumptions projection model required careful evaluation (e.g., underlying stock-recruitment relationship assumptions, estimated uncertainty current stock abundance levels). section titled “standardized projection model” developments SPM provided show compatibility types assessment models used N. Pacific groundfish. Programmatic Supplemental Environmental Impact Statement (PSEIS) extension first version SPM developed (2002). involved linking stock assessment information observed species compositions fishery. resulting multi-species technical interaction model (MSTIM) allowed evaluation alternative approaches groundfish fishery management federally managed waters Alaskan waters. MSTIM provides realistic catch-levels fed single-species stock projections. Previously, single-species evaluations typically done isolation issues regulatory limits overall catch level, bycatch constraints, effort development plans. data requirements MSPTIM extensive one goal provide simple approach providing catch-feedback function ABC levels, development simpler approach warranted. section title “multi-species considerations” simple model based historical patterns TACs, ABCs, catches proposed option estimating future TAC levels given future ABCs. projection model developments relate number ongoing research activities AFSC. example, North Pacific groundfish Management Strategy Evaluation (MSE) studies can use projection model easily evaluate current practices. Also, NMFS National Standard Guidelines (NSG) management Magnuson-Stevens Fisheries Management Conservation Act currently revision. projection model code designed easily adopted meet anticipated future demands.","code":""},{"path":[]},{"path":"/articles/01-Background.html","id":"stock-recruitment-relationship-specifications","dir":"Articles","previous_headings":"Standard projection model","what":"Stock-recruitment relationship specifications","title":"Standard Projection Model","text":"Ad-hoc meeting projection model approaches, report notes: “group discussed options improving projection model assumption recruitment (.e., varies mean level estimated 1978 recent estimated). particular, recruitment affected spawning stock biomass (SSB) levels considered realistic. Also, specifying degree autocorrelation residuals considered desirable. options using alternative stock-recruitment relationship projection model function SSB given : assume Bmsy=B35% , Fmsy = F35% solve > parameters assume Fmsy = F35% estimate stock-recruitment parameters > given stock-recruitment output assessment model simply estimate stock-recruitment parameters input > stock-recruitment output assessment model use estimates stock-recruitment parameters within > assessment model use prior distributions stock-recruitment parameters (Fmsy > Bmsy levels)… actual specification type stock-recruitment curve initially either Ricker B-Holt. group suggested option 2) good place start. noted assessment authors need supply estimates SSB match current estimates recruitment projection model. Adding autocorrelation future recruitment considered important, especially given medium-term patterns environmental variability apparently affect recruitment. specification autocorrelation function need ensure expected values correct.” option writing files annual (simulated) output now available different analyses can undertaken (currently, results summarized internally). standard projection model developed purposes Council authors EA exclusive—individuals encouraged undertake projection analyses time permits. SPM intended provide tool Council assessment models common utility project ABC OFL levels.","code":""},{"path":"/articles/01-Background.html","id":"input-files","dir":"Articles","previous_headings":"Standard projection model","what":"Input files","title":"Standard Projection Model","text":"Previously, standardized projection model evolved number different versions accommodate models sex-specific natural mortality, growth, multiple fisheries. Also, ability specify future catch scenarios added along standard EA alternatives. revised version developed flexibility deal options simple way. Additionally, features required NPFMC NMFS easily specify updated catch levels added, ability run number species within framework. simplify minimize inadvertent edits, input files split three separate files (Fig. 2). organized follows: Master Setup file Designed control assumptions dimension projections, give list different scenarios (e.g., listed Fig. ). catch data file Designed specify catch future year (use Region Council values updated) points species-specific assessment result data file species-specific assessment result data file Contains species model-run specific results assessment model Actual working examples provided following web page: www.afsc.noaa.gov/refm/stocks/projections.htm","code":""},{"path":"/articles/01-Background.html","id":"steps-for-doing-projections","dir":"Articles","previous_headings":"Standard projection model > Input files","what":"Steps for doing projections","title":"Standard Projection Model","text":"Run stock assessment model making note main demographic results, current numbers age historical stock-recruitment estimates Edit stock-specific input files (e.g., bottom panel Fig 2). Edit catch projections file includes assumptions future catch (e.g., middle panel Fig 2). Edit “setup.dat” file includes assumptions projection specifications (e.g., stock-recruitment relationship , types constraints, location name stock-specific detail files). file shown top panel Fig 2. Run projection model (e.g., use file “run.bat” typing follows: “run myfile” command line, myfile root file name selected (e.g., goa_pop)). Save evaluate results (examine files newly created myfile_out directory, currently include following: bigfile.full output file containing catch every simulated year bigsum.dat summarized version bigfile.F_profile.profile main characteristics fishing mortality srec.details stock-recruitment data fit means.General projection results species alternatives percentiles.Gives percentiles simulation results variability report.simple summary output (e.g., mean age, generation time) Repeat steps 4)-6) desired different model configurations etc. Repeat steps 3)-7) desired different impacts near-term catch levels Repeat steps 1)-8) desired evaluate different model results.","code":""},{"path":"/articles/01-Background.html","id":"example-results","dir":"Articles","previous_headings":"Standard projection model","what":"Example results","title":"Standard Projection Model","text":"Since fitting stock-recruitment relationship one major enhancements SPM, feature highlighted . particular, varying assumptions conditioning stock-recruitment relationship considered. noted main purpose including stock-recruitment relationship provide realistic assumptions expected recruitment levels stocks decline. exercise viewed rigorous assessment stock productivity. However, stock-recruitment analyses undeniably important management considerations presentation represents limited evaluation large set possible alternatives (e.g., low-frequency climate-driven changes stock productivity). Using estimates spawning biomass reported 2004 SAFE reports, fits conditioned (Fmsy = F35% ) unconditioned (fit stock-recruitment data ) options reasonably consistent (Fig. ). Examining yield cases shows without conditioning, stocks extremely high levels Fmsy adding conditions tends reduce level Fmsy (Fig. ). understand implications using stock-recruitment relationship projection model, useful undertake contrasts. first example, “author’s recommended” ABC level specified 40 times current maximum permissible ABC level Amendment 56 FMP. intent evaluate performance stock extreme levels fishing mortality. However, since parts control-rule implemented “Author’s recommended” option, actual catch high first year since spawning biomass held low levels (thus requiring large adjustments current control rule; Fig. .). Note low levels current practice using recent mean recruitment (variability) results optimistic outcome. evaluate stock-recruitment influence projections, second set runs completed fishing mortality rate unadjusted simply held value 1.0. scenario stock completely collapsed 15 years stock-recruitment relationship included held 2% current spawning biomass level mean-recruitment assumption (Fig. .).","code":""},{"path":"/articles/01-Background.html","id":"multi-species-considerations","dir":"Articles","previous_headings":"","what":"Multi-species considerations","title":"Standard Projection Model","text":"section simple method modeling TACs demonstrated applied using new version SPM.","code":""},{"path":"/articles/01-Background.html","id":"data","dir":"Articles","previous_headings":"Multi-species considerations","what":"Data","title":"Standard Projection Model","text":"part effort develop standardized database archival analytical purposes, information gleaned SAFE reports, Federal Register notices, NPFMC documents, NMFS Regional Office obtained. Specifically, TAC, ABC, possible, OFL levels compiled stocks areas. discrepancies reports found existed, numbers Federal Register notice given highest precedence. initial layout database shown Table 1. database allows straightforward flexible cross-tabulations (e.g., Table ). first step evaluating historical patterns TAC species groups, set pair-wise plots constructed. show EBS pollock TAC proportion negatively correlated flatfish species addition others Pacific cod TAC proportion largely independent TACs full period available data data since 1989 (Figs. & ). Since ABC levels one main determinants TACs serving upper bound, effect ABCs compared main species group. Pacific cod TAC levels relatively independent main species ABCs (except Pacific cod ABC levels). inverse relationship pollock ABCs flatfish TACs apparent. Pollock TAC affected pollock ABC limit 75% overall TAC (2 million t).","code":""},{"path":"/articles/01-Background.html","id":"a-multispecies-example-of-estimating-tacs-given-abcs","dir":"Articles","previous_headings":"Multi-species considerations","what":"A multispecies example of estimating TACs given ABCs","title":"Standard Projection Model","text":"illustration, approach estimate TAC levels main species groups developed using piecewise regression model fit historical ABCs TACs 1989-2004 (Table ). formulation first required defining breakpointswhere m number segments coefficient estimated. species, ABCs normalized maximum 1.0 time values breakpoints thus specified equally spaced bins (.e., ). TAC year t stock j can thus given : equal ABC ith stock year t parameter matrix dimension estimated (n total number stocks consideration). approach somewhat simpler applying GAM (generalized additive model) data shown outperform simple multiple regression approaches. Experimentation different values m suggested little improvements seen m > 5. results presented , value m=5 used. Moderate second-difference penalties placed values ensure estimability segments data scarce non-existent (.e., values tend towards mean level). approach resulted reasonably good fits historical patterns (Fig. ). projection model, coefficients regression used along added constraint future year t, (.e., TAC species j predicted model must less equal ABC year). code estimation provided Appendix.","code":""},{"path":"/articles/01-Background.html","id":"results-of-multispecies-projections","dir":"Articles","previous_headings":"Multi-species considerations","what":"Results of multispecies projections","title":"Standard Projection Model","text":"example using standard projection approach, 500 simulations conducted 30 year period beginning 2004. future year (beyond 2006) catch specified using algorithm. Mean values results presented Table . (NOTE, table ABC OFL levels specified future year also available, SSB (minimal) estimate distribution catches (.e., actual uncertainty future catches much higher). mean trajectories TACs show stabilization trends 10-15 years (Fig. ).","code":""},{"path":"/articles/01-Background.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Standard Projection Model","text":"number changes SPM completed. ability easily configure different catch scenarios relevant stocks implemented simple sets data files (refinements expected). help facilitate Council Plan Teams NMFS RO ABC OFL levels require future years. Options specify stock-recruitment relationships (primarily realistic projections) added. code allows technical interactions (general) example using simpler form “optimized” (LP) method used PSEIS presented. Future specifications include autocorrelation recruitment residuals. Additionally, ability simulate estimates current stock-size uncertainty planned (perhaps extended apply Alt 3b PSEIS). minor modifications input files, trophic level output can easily generated anticipated included future versions. also envisioned extensions Tier 4 lower species possible (done PSEIS).","code":""},{"path":"/articles/01-Background.html","id":"references-to-be-revised","dir":"Articles","previous_headings":"","what":"References (to be revised)","title":"Standard Projection Model","text":"Ackley, D. 1995. Bering Sea Fishery Simulation Model. Alaska Fishery Research Bulletin 2(1): 83-86. Brown, B.E. , J.. Brennan, J.E. Palmer. 1979. Linear programming simulations effects bycatch management mixed species fisheries northeastern coast United States. Fishery Bulletin 76:851-860. Larson, D .M., House, B. W. Terry, J. M. 1996. Towards Efficient Bycatch management Multispecies Fisheries: Nonparametric Approach. Marine Resource Economics 11: 181-201. Marasco, R.J. Terry, J.M. 1982. Controlling Incidental Catch: Economic Analysis Six Management Options. Marine Policy 14:131-139. Murawski, S.., Finn, J.T. 1986. Optimal effort allocation among competing mixed-species fisheries, subject fishing mortality constraints. Canadian Journal Fisheries Aquatic Sciences 43:90-100. Press, W.H., Teukolsky, S.., Vetterling, W.T. Flannerty, B.P. 1992. Numerical Recipes C: Art Scientific Computing. 2nd Edition. Cambridge University Press. New York.","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"/articles/01-Background.html","id":"table-4--example-of-projected-catch-estimates-for-the-main-bsai-groundfish-species--note-that-others-arent-included-e-g--those-stocks-for-which-an-age-structured-assessment-is-unavailable-","dir":"Articles","previous_headings":"","what":"Standard Projection Model","title":"Standard Projection Model","text":"Alaska Plaice Nrthrn Rockfish","code":""},{"path":[]},{"path":"/articles/01-Background.html","id":"appendixprojection-model-details","dir":"Articles","previous_headings":"","what":"Appendix—projection model details","title":"Standard Projection Model","text":"following presents details steps projection simulations. glossary notation provided end section reference.","code":""},{"path":[]},{"path":"/articles/01-Background.html","id":"a-recruitment-projections-similar-to-selected-period-current-practice","dir":"Articles","previous_headings":"Appendix—projection model details > Recruitment options","what":"a) Recruitment projections similar to selected period (current practice)","title":"Standard Projection Model","text":"option, recruitment estimates selected years (e.g., 1978-2003 largest available subset thereof) obtained respective 2004 stock assessments. stock, recruitments used find maximum likelihood estimates inverse Gaussian distribution parameters. distribution parameterized one parameters represented distribution mean. recruitment time series obtained simulation drawing randomly parametric distribution.","code":""},{"path":"/articles/01-Background.html","id":"b-recruitment-projections-based-on-estimates-from-stock-recruitment-output-estimates-from-stock-assessment-model-otherwise-unconditioned","dir":"Articles","previous_headings":"Appendix—projection model details > Recruitment options","what":"b) Recruitment projections based on estimates from stock-recruitment output (estimates from stock assessment model, otherwise unconditioned)","title":"Standard Projection Model","text":"option, spawning biomass recruitment estimates selected years (e.g., 1978-2003 largest available subset thereof) obtained respective 2004 stock assessments. stock, recruitments used find maximum likelihood estimates stock-recruitment relationship parameters (e.g., steepness, R­0, σR). random number seed results generation standard normal deviates applied (bias-corrected) stock-recruitment curve follows log-normal distribution.","code":""},{"path":"/articles/01-Background.html","id":"c-recruitment-projections-based-on-conditioned-estimates-from-stock-recruitment-output-estimates-from-stock-assessment-model-but-conditioned-such-that-f35-fmsy","dir":"Articles","previous_headings":"Appendix—projection model details > Recruitment options","what":"c) Recruitment projections based on conditioned estimates from stock-recruitment output (estimates from stock assessment model, but conditioned such that F35% = Fmsy)","title":"Standard Projection Model","text":"option, spawning biomass recruitment estimates selected years (e.g., 1978-2003 largest available subset thereof) obtained respective 2004 stock assessments. stock, recruitments used find maximum likelihood estimates stock-recruitment relationship parameters (e.g., steepness, R­0, σR). random number seed results generation standard normal deviates applied (bias-corrected) stock-recruitment curve follows log-normal distribution.","code":""},{"path":"/articles/01-Background.html","id":"d-recruitment-projections-based-on-conditioned-stock-recruitment-relationship-estimates-solely-conditioned-such-that-b35-bmsy-and-f35-fmsy","dir":"Articles","previous_headings":"Appendix—projection model details > Recruitment options","what":"d) Recruitment projections based on conditioned stock-recruitment relationship (estimates solely conditioned such that B35% = Bmsy and F35% = Fmsy)","title":"Standard Projection Model","text":"option, stock-recruitment relationship (given shape curve) conditioned B35% = Bmsy F35% = Fmsy. spawning biomass recruitment estimates selected years (e.g., 1978-2003 largest available subset thereof) obtained respective 2004 stock assessments included, given little weight (remain model obtain estimates σR. stock, recruitments used find maximum likelihood estimates stock-recruitment relationship parameters (e.g., steepness, R­0, σR). random number seed results generation standard normal deviates applied (bias-corrected) stock-recruitment curve follows log-normal distribution.","code":""},{"path":"/articles/01-Background.html","id":"estimating-actual-fishing-mortality-rates-for-the-initial-year","dir":"Articles","previous_headings":"Appendix—projection model details > Recruitment options","what":"Estimating actual fishing mortality rates for the initial year","title":"Standard Projection Model","text":"needed (e.g., projection years catch specified externally), fishing mortality rate set catch equal Ct solved following implicit equation:","code":""},{"path":"/articles/01-Background.html","id":"project-numbers-at-age-for-all-ages-years-and-simulations","dir":"Articles","previous_headings":"Appendix—projection model details > Recruitment options","what":"Project numbers-at age for all ages, years, and simulations","title":"Standard Projection Model","text":"scenario, specified number projection simulations conducted. projected numbers age year based annual feedback “actual” catch required. steps projections (given species) follows: 1) Initialize simulation index: 2) Increment simulation index: 3) Initialize time index: 4) Compute numbers age initial year simulation u: 5) Set fishing mortality rate year t' simulation u: 6) Increment time index: 7) Compute numbers age year t simulation u: 1 =1, 1< < nage, = nage,. 9) Compute ABC fishing mortality rate establishes TAC year t simulation u. appropriate fishing mortality rate determined projection year relative spawning biomass stock shown table (Bref corresponds B40% cases unless otherwise specified). Fref corresponds fishing mortality specified FABC value. total mortality rate beginning year time spawning. value computed iteratively (since can function fishing mortality). Note also alternatives (described ) rules change species. given Alternative , fishing mortality treated function FABC value: specified alternative. 10) Compute TAC value annually varying limit catch. given species value (alternative ) projection model computes TAC used constraint . 11) Compute actual catch, , specified TAC model initial projection year. 12) Solve fishing mortality rate set catch equal year t simulation u (estimated multispecies management constrained optimization problem described varies alternative) solving following implicit equation: 13) Check see years simulation u completed, continue necessary: t<npro+1, return (6) t=npro+1, end simulation u. 14) Return (2) simulations complete.","code":""},{"path":"/articles/01-Background.html","id":"step-5-store-stock-performance-statistics-from-the-above-projections","dir":"Articles","previous_headings":"Appendix—projection model details > Recruitment options","what":"Step 5: Store stock performance statistics from the above projections","title":"Standard Projection Model","text":"series individual stock performance indicators (species age-structure results specified) computed separately alternative described follows. Total biomass year simulation: Spawning biomass catch (specified ) stored species, year simulation. Approximate confidence bounds computed simulation output simply ranking results simulations computing percentile values corresponding desired intervals (taken 10th 90th percentile). Also computed implied spawning biomass per-recruit (SPR) rate given level catch single year simulation. example, theoretical percentage unfished spawning output expected single recruit fishing mortality equal estimated fishing mortality life species. Average age stock final projection year across simulations also computed :","code":""},{"path":[]},{"path":"/articles/01-Background.html","id":"dimensions","dir":"Articles","previous_headings":"Appendix—projection model details > Glossary of symbols used in description of the model","what":"Dimensions","title":"Standard Projection Model","text":"amax Maximum age used model (plus group) amin Minimum age used model nage Number ages model ngear Number gear types separate selectivity schedules used (assessments) npro Number years project beyond initial year simulation nsims Number simulations Number gears allocation constraints nFsh Number fisheries nsp Number species narea Number management areas defined species","code":""},{"path":"/articles/01-Background.html","id":"indices","dir":"Articles","previous_headings":"Appendix—projection model details > Glossary of symbols used in description of the model","what":"Indices","title":"Standard Projection Model","text":"Relative age index, 1anage g Fishery index, 1gnFsh k Sub-area h Fishing gear type t Projection year index, 1tnpro t' Projection year index, 1t'number projection years catch pre-specified u Simulation index, 1unsims Alternative index j Species index","code":""},{"path":"/articles/01-Background.html","id":"life-history-and-fishery-parameters","dir":"Articles","previous_headings":"Appendix—projection model details > Glossary of symbols used in description of the model","what":"Life History and Fishery Parameters","title":"Standard Projection Model","text":"dh Proportion total instantaneous fishing mortality rate distributed gear h Ma Natural mortality rate age ma Proportion age fish mature wa Weight--age population p Proportion females population sa,h Selectivity gear type h fish age (scaled max(s)=1) wa,h Weight age fish sampled gear h","code":""},{"path":"/articles/01-Background.html","id":"other-parameters-and-expressions-used-in-projections","dir":"Articles","previous_headings":"Appendix—projection model details > Glossary of symbols used in description of the model","what":"Other Parameters and Expressions Used in Projections","title":"Standard Projection Model","text":"SPR Spawning biomass per recruit ABC Acceptable biological catch TAC Total allowable catch Bref parameter control rules used set overfishing rate constrain FABC Bt,u Spawning biomass projection year t simulation u Ct,u Catch projection year t simulation u population Ft,u Fishing mortality rate projection year t simulation u population Flim parameter control rule used set overfishing rate Fref parameter control rule used constrain FABC Fishing mortality rate projection year t simulation u population Total mortality rate beginning year spawning period Na,t Numbers age projection year t Na,t,u Numbers age projection year t simulation u na Numbers age initial year Ot,u Rate fishing mortality constitutes overfishing projection year t simulation u P Probability overfishing least one year projection period Rt,u Recruitment projection year t simulation u Tt,u Total biomass (ages amin amax) projection year t simulation u TACt TAC actually specified t Average age stock final projection year across simulations","code":""},{"path":"/articles/01-Background.html","id":"computation-of-spr-values","dir":"Articles","previous_headings":"Appendix—projection model details > Glossary of symbols used in description of the model","what":"Computation of SPR values","title":"Standard Projection Model","text":"Using species specific demographic values, fishing mortality rates (e.g., ) reduce female spawning stock (per recruit) fraction unfished level. age-specific factors : selectivity, natural mortality, maturity, weight fecundity. example, compute algorithm solve following set implicit equations used: corresponds spawning stock per recruit population p unfished equilibrium state. information used within management rule determines quota. species alternatives different F-spr rates used.","code":""},{"path":"/articles/01-Background.html","id":"appendixcode-for-fitting-tac-given-historical-abc-levels","dir":"Articles","previous_headings":"","what":"Appendix—code for fitting TAC given historical ABC levels","title":"Standard Projection Model","text":"DATA_SECTION int nsd !! nsd=5; init_int nnodes init_number samplesize init_number pen_spp init_number pen_nodes init_int nspp init_int nyrs int nobs !! nobs = nspp*nyrs*nspp; init_matrix data(1,nobs,1,5) 3darray obs_tac(1,nyrs,1,nspp,1,nspp) 3darray obs_abc(1,nyrs,1,nspp,1,nspp) 3darray rescaled_abc(1,nyrs,1,nspp,1,nspp) vector maxabc(1,nspp) number offset; imatrix inode(1,nyrs,1,nspp) LOCAL_CALCS maxabc.initialize(); (int =1;<=nobs;++) { // TAC_Spp ABC_Spp Yr ABC TAC obs_abc(data(,3),data(,1),data(,2)) = data(,4); obs_tac(data(,3),data(,2),data(,1)) = data(,5); (obs_abc(data(,3),data(,1),data(,2)) > maxabc(data(,2))) maxabc(data(,2)) = obs_abc(data(,3),data(,1),data(,2)) ; } int ijunk; offset = 0.; (int =1;<=nyrs;++) { (int j=1;j<=nspp;j++) { (int k=1;k<=nspp;k++) rescaled_abc(,j,k) = obs_abc(,j,k)/maxabc(k); (int k=1;k<=nspp;k++) { ijunk = int(rescaled_abc(,j,k)*nnodes) ; inode(,k) = ijunk; } obs_tac(,j) /= sum(obs_tac(,j)); } offset -= samplesize * obs_tac(,1) * log(obs_tac(,1)); } END_CALCS PARAMETER_SECTION number tac_pen; init_bounded_matrix theta(0,nnodes,1,nspp,-8,8,1) matrix pred_tac(1,nyrs,1,nspp) matrix abc_tac(1,nyrs,1,nspp) sdreport_matrix sdTAC(1,nsd,1,nspp) vector like(1,4); objective_function_value obj_fun PROCEDURE_SECTION like.initialize(); pred_tac.initialize(); tac_pen=0.0; (int =1;<=nyrs;++) { (int j=1;j<=nspp;j++) { pred_tac(,j) += rescaled_abc(,1,j) * mfexp(theta(inode(,j),j)) ; } pred_tac() /= sum(pred_tac()); } int ijunk; (int =1;<=nsd;++) { (int j=1;j<=nspp;j++) { ijunk = int( double()/nsd * nnodes) ; sdTAC(,j) = double()/double(nsd) * mfexp( theta(ijunk,j) ) ; } } // Fit TAC portions (int =1;<=nyrs;++) like(1) -= samplesize * obs_tac(,1) * log(pred_tac()) ; like(1) -= offset; // Penalize differences theta species... (int =0;<=nnodes;++) like(2) += pen_spp * norm2(first_difference(first_difference(theta()))); // Penalize differences theta nodes... (nnodes >1) (int j=1;j<=nspp;j++) like(3) += pen_nodes*norm2(first_difference(first_difference(trans(theta)(j)))); // Penalize TAC less ABC's... dvariable xtmp; (int =1;<=nyrs;++) { (int j=1;j<=nspp;j++) { abc_tac(,j) = obs_abc(,1,j)-(2.0*pred_tac(,j)); xtmp = posfun( (abc_tac(,j) ), 0.2 , tac_pen ); } } like(4) = 20.*tac_pen; obj_fun = sum(like); REPORT_SECTION report<<\"Obs_TAC \" <<endl; (int =1;<=nyrs;++) report<<2.*obs_tac(,1)<< \" Pred: \"<<<<\" \"<<2.*pred_tac()<<endl; report<<\"Pred_TAC \" <<endl; (int =1;<=nyrs;++) report<<2.*pred_tac()<<endl; report<<\"Obs_ABC \" <<endl; (int =1;<=nyrs;++) report<<rescaled_abc(,1)<<endl; report<<\"Obs_ABC/Pred_TAC \" <<endl; (int =1;<=nyrs;++) report<<abc_tac()<<endl; report<<\"#_Nodes,_samsize,_penaltyspp,_pennode,_Likelihoods\"<<endl; report<<nnodes<<\" \"<<samplesize<<\" \"<<pen_spp<<\" \"<<pen_nodes<<\" \"<<like<<endl; report<<\"TAC_by_nodes\"<<endl; (int =1;<=nsd;++) report<<sdTAC()<<endl; ofstream ofs(\"tacpar.dat\"); ofs << nspp <<endl; ofs << nnodes <<endl; ofs << maxabc <<endl; ofs << theta <<endl; ofs.close(); TOP_OF_MAIN_SECTION gradient_structure::set_MAX_NVAR_OFFSET(1600); gradient_structure::set_GRADSTACK_BUFFER_SIZE(200000); gradient_structure::set_NUM_DEPENDENT_VARIABLES(800); gradient_structure::set_CMPDIF_BUFFER_SIZE(2000000);","code":""},{"path":"/articles/02-MoreDoc.html","id":"projections-for-operational-assessments","dir":"Articles","previous_headings":"","what":"Projections for operational assessments","title":"Draft additional documentation for spmR","text":"R package spmR provides tool project assessment results consistent way “Tier 3” groundfish stocks. conform Fishery Management Plan (FMP) Gulf Alaska (GOA) Bering Sea Aleutian Islands (BSAI). Specifically, outlined Amendment 56 FMP, age-structured assessment results linked projection based specified input files. inputs allow estimation fishing mortality rates based spawning biomass per recruits (e.g., F40% F35%). rates (variants) applied estimated abundance age recent assessment model. trend spawning biomass contrasted proxy reference points align FMP. summary, model estimates proxy Fmsy values, applied estimated population numbers age, compared reference points adjust rates according control rule FMP. Catch model follows three main scenarios given selected model (approved SSC): maximum permissible ABC status determination relative overfishing status determination determine stock overfished approaching overfished condition. Additional “scenarios” optionally included part historical requirement annual Environmental Assessment ABC/OFL specifications Alaska Regional Office. provide contrast included scenarios based “author recommended” ABC, one fishing, one based recent 5-year average F, another alternative F-spr basis (varied stocks). Biological assumptions used projections follow assessment model decisions expected future selectivity, maturity, weight--age etc considered best estimates may reflect means different recent periods. noted specification clearly documented within assessment. Tier 3 stocks based expected trends extent proxy estimates determined uncertainty explicitly part FMP ABC/OFL specification process. Nonetheless, software runs simulations mean variability recruitment specified model input files. FMP ABC/OFL specifications, means presented longer-term trajectories accounting recruitment variability presented figures deemed useful.","code":""},{"path":"/articles/02-MoreDoc.html","id":"abbreviations","dir":"Articles","previous_headings":"","what":"Abbreviations","title":"Draft additional documentation for spmR","text":"​​ *IRFA** Magnuson-Stevens Fishery Conservation Management Act *MMPA** Environmental Assessment/Regulatory Impact Review *NMFS** *NOAA** North Pacific Fishery Management Council *PEEC** *SAFE** FQ IP HC International Pacific Halibut Commission","code":""},{"path":"/articles/02-MoreDoc.html","id":"recommended-usage","dir":"Articles","previous_headings":"","what":"Recommended usage","title":"Draft additional documentation for spmR","text":"See readme spmR package github installation options vignettes (Articles ).","code":""},{"path":"/articles/02-MoreDoc.html","id":"history-of-spm","dir":"Articles","previous_headings":"","what":"History of SPM","title":"Draft additional documentation for spmR","text":"<links historical docs> https://afsc-assessments.github.io/spmR/articles/01-Background.html spmr grew “proj” differences ","code":""},{"path":"/articles/02-MoreDoc.html","id":"definitions","dir":"Articles","previous_headings":"","what":"Definitions","title":"Draft additional documentation for spmR","text":"Let TY= year - year SPM run AY= last year assessment done, AY<=TY PY1= TY+1 = projection year 1 exec table PY2= TY+2 = projection year 2 exec table PYn=TY+n = projection year n alternative scenarios C_TY=estimate/assumed catch entirety TY using e.g., assumption catch=ABC calculation extrapolate remainder TY (Oct - Dec). N_AY= numbers age Jan-1 AY N_PY1= numbers age Jan-1 PY1 N_PY2= numbers age Jan-1 PY2","code":""},{"path":"/articles/02-MoreDoc.html","id":"summary-of-spr-calculations-for-tier-3-stocks","dir":"Articles","previous_headings":"","what":"Summary of SPR calculations for Tier 3 stocks","title":"Draft additional documentation for spmR","text":"SPM reads (average) biological input values: M, maturity, spawning fisheries WAA, fisheries selectivity. Uses spawner per recruit (SPR) approach calculate SPR F=0, .e., much female spawning biomass (tons, kg, etc.) single recruit produces lifetime. Uses vector recruitments calculate mean recruits (Rbar), multiplied spawning biomass per recruit F=0 get unfished SSB (SSB0 SSB100%). define SSB35=.35*SB100 SB40=0.40*SB100. equilibrium values given assumptions Rbar, biology, selectivity. Uses numerical solver find F35%=FMSY=FOFL F40%=FmaxABC equilibrium tuning F SSB SSB35 SSB40, respectively. go executive table. Proj next takes N_AY inputted catches get N_PY1. applies F_ABC, modified harvest control rule, get ABC PY1. assumption made catch taken PY1, N_PY2 calculated F_ABC applied get ABC PY2. similar approach used OFL. assumption depends scenarios (see ), scenario X used dictates ABC taken PY1.","code":""},{"path":"/articles/02-MoreDoc.html","id":"summary-of-the-alternative-scenario-simulations","dir":"Articles","previous_headings":"","what":"Summary of the alternative scenario simulations","title":"Draft additional documentation for spmR","text":"7 projection “scenarios” built spmR, along others customized address specific questions.","code":""},{"path":[]},{"path":"/articles/02-MoreDoc.html","id":"how-to-specify-catches-in-ty","dir":"Articles","previous_headings":"","what":"How to specify catches in TY","title":"Draft additional documentation for spmR","text":"Years AY TY finalized total catches available. total catches TY complete must assumed. Several approaches used: full ABC taken TY. reasonable fully exploited stocks. may wise general rule conservative. lightly exploited stocks may . Extrapolate catches TY end year using catches October historical catch patterns fishery. E.g., 80% total catches typically taken October can scaled number.","code":""},{"path":"/articles/02-MoreDoc.html","id":"known-issues","dir":"Articles","previous_headings":"","what":"Known issues","title":"Draft additional documentation for spmR","text":"using time-varying quantities model average values used proj construct N_PY1 match used assessment thus much. instance spawning WAA different, N_PY match SPM TY, spawning biomass TY match. fisheries selectivity different, N_PY1 differ different fish killed beginning end TY. time-varying inputs SPM able recreate TY identically issue. Cases SPM needs run . Weird issues arising ’s big gap AY TY.","code":""},{"path":"/articles/02-MoreDoc.html","id":"multispecies-and-other-advanced-features","dir":"Articles","previous_headings":"","what":"Multispecies and other advanced features","title":"Draft additional documentation for spmR","text":"Jim one SRR conditioning Multispecies technical interactions Linear programming total yield cap","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jim Ianelli. Maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Ianelli J (2024). spmR: Standard Projection model. R package version 0.1.0, http://afsc-assessments.github.io/spmR/.","code":"@Manual{,   title = {spmR: Standard Projection model},   author = {Jim Ianelli},   year = {2024},   note = {R package version 0.1.0},   url = {http://afsc-assessments.github.io/spmR/}, }"},{"path":"/index.html","id":"readme","dir":"","previous_headings":"","what":"Standard Projection model","title":"Standard Projection model","text":"Jim Ianelli 2023-09-15","code":""},{"path":"/index.html","id":"standard-projection-model-for-alaska-groundfish","dir":"","previous_headings":"","what":"Standard Projection Model for Alaska Groundfish","title":"Standard Projection model","text":"standard projection code federally managed Alaskan groundfish species Tier 3. file src/spm.tpl main code running projections. Required input files spm.dat, tacpar.dat, species-specific data input file key outputs assessment, examples/data/ai_spm.dat. Note: spm.dat combines information two files used previous versions projection code (setup.dat spp_catch.dat) ADMB version 13.0 higher required compile spm.tpl. steps run projection code: 1. Compile src/spm.tpl using admb copy spm.exe folder spm.dat, tacpar.dat, file containing assessment outputs, ai_spm.dat 2. Within spm.dat specify location assessment input file relative folder spm.exe 3. command line pointed folder inputs, type “spm”","code":""},{"path":"/index.html","id":"east-bering-sea-pollock-","dir":"","previous_headings":"","what":"East Bering Sea pollock","title":"Standard Projection model","text":"R package spmR developed stock projections groundfish AFSC. model coded using Autodif (AD) Model Builder (ADMB) software.","code":""},{"path":"/index.html","id":"cloning-the-repository-optional","dir":"","previous_headings":"","what":"Cloning the repository (optional)","title":"Standard Projection model","text":"R package spmR lives public GitHub repository. repository can cloned computer command line using user interface. command line using Linux repository can cloned using:","code":"git clone https://github.com/afsc-assessments/spmR"},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Standard Projection model","text":"several options installing spmR R package.","code":""},{"path":"/index.html","id":"option-1","dir":"","previous_headings":"Installation","what":"Option 1","title":"Standard Projection model","text":"spmR package can installed within R using:","code":"devtools::install_github(repo = \"afsc-assessments/spmR\", dependencies = TRUE,                           build_vignettes = TRUE, auth_token = \"your_PAT\")"},{"path":"/index.html","id":"option-2","dir":"","previous_headings":"Installation","what":"Option 2","title":"Standard Projection model","text":"GitHub repository can cloned computer package installed command line. Linux involve:","code":"git clone https://github.com/afsc-assessments/spmR R CMD INSTALL spmR"},{"path":"/index.html","id":"option-3","dir":"","previous_headings":"Installation","what":"Option 3","title":"Standard Projection model","text":"time within R using:","code":"devtools::install(\"spmR\")"},{"path":"/index.html","id":"help","dir":"","previous_headings":"","what":"Help","title":"Standard Projection model","text":"Help spmR functions data sets can found R help pages associated function data set. Help specific function can viewed using ?function_name, example: Alternatively, see list available functions data sets use:","code":"?run_model ?tab_fit ?plot_sel help(package = \"spmR\")"},{"path":"/index.html","id":"examples","dir":"","previous_headings":"","what":"Examples","title":"Standard Projection model","text":"package vignettes great place see spmR can . can view package vignettes within R using:","code":"browseVignettes(package = \"spmR\") vignette(topic = \"spmR\", package = \"spmR\")"},{"path":"/index.html","id":"website","dir":"","previous_headings":"","what":"Website","title":"Standard Projection model","text":"vignettes help pages function bundled together published website https://afsc-assessments.github.io/spmR/.","code":""},{"path":"/index.html","id":"developers","dir":"","previous_headings":"","what":"Developers","title":"Standard Projection model","text":"Developers want things slightly differently. See Model development vignette.","code":""},{"path":"/index.html","id":"acronymns","dir":"","previous_headings":"","what":"Acronymns","title":"Standard Projection model","text":"NOAA: National Oceanic Atmospheric Administration NMFS: National Marine Fisheries Service AFSC: Alaska Fisheries Science Center REFM: Resource Ecology Fisheries Management","code":""},{"path":"/index.html","id":"legal-disclaimer","dir":"","previous_headings":"","what":"Legal disclaimer","title":"Standard Projection model","text":"repository software product official communication National Oceanic Atmospheric Administration (NOAA), United States Department Commerce (DOC). NOAA GitHub project code provided ‘’ basis user assumes responsibility use. claims DOC DOC bureaus stemming use GitHub project governed applicable Federal law. reference specific commercial products, processes, services service mark, trademark, manufacturer, otherwise, constitute imply endorsement, recommendation, favoring DOC. DOC seal logo, seal logo DOC bureau, shall used manner imply endorsement commercial product activity DOC United States Government.","code":""},{"path":"/reference/dat2list.html","id":null,"dir":"Reference","previous_headings":"","what":"Read Data File into List Object — dat2list","title":"Read Data File into List Object — dat2list","text":"Reads data file formatted projection model converts list object. function handles numeric NA values appropriately.","code":""},{"path":"/reference/dat2list.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read Data File into List Object — dat2list","text":"","code":"dat2list(fn)"},{"path":"/reference/dat2list.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read Data File into List Object — dat2list","text":"fn Filename data file read.","code":""},{"path":"/reference/dat2list.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read Data File into List Object — dat2list","text":"list object containing data file.","code":""},{"path":"/reference/dat2list.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read Data File into List Object — dat2list","text":"","code":"# Example usage: # myDataList <- dat2list(\"datafile.dat\")"},{"path":"/reference/hello.html","id":null,"dir":"Reference","previous_headings":"","what":"Hello, World! — hello","title":"Hello, World! — hello","text":"Prints 'Hello, world!'.","code":""},{"path":"/reference/hello.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Hello, World! — hello","text":"","code":"hello()"},{"path":"/reference/hello.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Hello, World! — hello","text":"","code":"hello() #> Error in hello(): could not find function \"hello\""},{"path":"/reference/list2dat.html","id":null,"dir":"Reference","previous_headings":"","what":"Write List Object to Projection Model Data File — list2dat","title":"Write List Object to Projection Model Data File — list2dat","text":"function writes list object file formatted projection model. element list written header.","code":""},{"path":"/reference/list2dat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write List Object to Projection Model Data File — list2dat","text":"","code":"list2dat(D, fn, hdr = \"a new file\")"},{"path":"/reference/list2dat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write List Object to Projection Model Data File — list2dat","text":"D List object written. fn Filename data written. hdr Header text included file.","code":""},{"path":"/reference/list2dat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write List Object to Projection Model Data File — list2dat","text":"function return value; writes file.","code":""},{"path":"/reference/list2dat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Write List Object to Projection Model Data File — list2dat","text":"","code":"# Example usage: # list2dat(myList, \"datafile.dat\", \"Header for new file\")"},{"path":"/reference/plotSPM.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Results from SPM Analysis from a Tibble — plotSPM","title":"Plot Results from SPM Analysis from a Tibble — plotSPM","text":"function creates plots results Stock Production Model (SPM) analysis contained tibble. generates three separate plots different metrics combines using `patchwork` package.","code":""},{"path":"/reference/plotSPM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Results from SPM Analysis from a Tibble — plotSPM","text":"","code":"plotSPM(df, alt = 2, thisyr = 2022, mytitle = NULL)"},{"path":"/reference/plotSPM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Results from SPM Analysis from a Tibble — plotSPM","text":"df tibble containing results `spm_detail.csv`. alt alternative plotted. thisyr current year projection model. mytitle Title plot","code":""},{"path":"/reference/plotSPM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Results from SPM Analysis from a Tibble — plotSPM","text":"combined plot results SPM analysis.","code":""},{"path":"/reference/print_Tier3_tables.html","id":null,"dir":"Reference","previous_headings":"","what":"Print Tier 3 Tables — print_Tier3_tables","title":"Print Tier 3 Tables — print_Tier3_tables","text":"Generates prints HTML tables Tier 3 projections including catch, ABC, fishing mortality, spawning biomass various scenarios.","code":""},{"path":"/reference/print_Tier3_tables.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print Tier 3 Tables — print_Tier3_tables","text":"","code":"print_Tier3_tables(df, modname = \"base\", stock = \"BSAI Atka mackerel\")"},{"path":"/reference/print_Tier3_tables.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print Tier 3 Tables — print_Tier3_tables","text":"df Data frame containing Tier 3 data. modname Name model used, defaults \"base\". stock Name stock, defaults \"BSAI Atka mackerel\".","code":""},{"path":"/reference/print_Tier3_tables.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print Tier 3 Tables — print_Tier3_tables","text":"HTML tables specified Tier 3 data.","code":""},{"path":"/reference/print_Tier3_tables.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print Tier 3 Tables — print_Tier3_tables","text":"","code":"# Example usage: # print_Tier3_tables(myDataFrame, \"model1\", \"Some Fish Stock\")"},{"path":"/reference/runSPM.html","id":null,"dir":"Reference","previous_headings":"","what":"Run SPM Analysis in a Specific Directory — runSPM","title":"Run SPM Analysis in a Specific Directory — runSPM","text":"function runs Stock Production Model (SPM) analysis specified directory. function changes working directory `dirname`, runs SPM analysis, reads results `spm_detail.csv`. returns original working directory completing analysis.","code":""},{"path":"/reference/runSPM.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run SPM Analysis in a Specific Directory — runSPM","text":"","code":"runSPM(dirname, ctrl = NULL, run = FALSE)"},{"path":"/reference/runSPM.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run SPM Analysis in a Specific Directory — runSPM","text":"dirname string specifying directory run SPM analysis. ctrl Optional control settings SPM analysis. NULL, default settings used.","code":""},{"path":"/reference/runSPM.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run SPM Analysis in a Specific Directory — runSPM","text":"data frame containing results `spm_detail.csv`.","code":""},{"path":"/reference/runSPM.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run SPM Analysis in a Specific Directory — runSPM","text":"","code":"runSPM(\"examples/atka\") #> Error: 'examples/atka/spm_detail.csv' does not exist in current working directory ('/Users/jim/_mymods/afsc-assessments/spmR/docs/reference')."}]
